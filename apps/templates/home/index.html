{% extends "layouts/base.html" %}

{% block title %} Dashboard {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
			
	<div class="content">
		<div class="panel-header bg-primary-gradient">
			<div class="page-inner py-5">
				<div class="d-flex align-items-left align-items-md-center flex-column flex-md-row">
					<div>
						<h2 class="text-white pb-2 fw-bold">Dashboard</h2>
					</div>
					{% if user.is_staff %}
					<div class="ml-md-auto py-2 py-md-0">
						<a href="/admin" class="btn btn-white btn-border btn-round mr-2">Manage</a>
					</div>
					{% endif %}
				</div>
			</div>
		</div>
		<div class="page-inner mt--5">
			
			<div class="row mt--2">
				<div class="col-md-12">
					<div class="card full-height">
						<div class="card-body">
							<div class="card-title">Overall Statistics</div>
							<div class="card-category">Information about statistics in system</div>
							<p></p>
							<div class="row">
								<div class="col d-flex">
									<div class="flex-fill">
										<div class="card card-stats card-primary card-round">
											<div class="card-body">
												<div class="row">
													<div class="col-5">
														<div class="icon-big text-center">
															<i class="fas fa-building"></i>
														</div>
													</div>
													<div class="col-7 col-stats">
														<div class="numbers">
															<p class="card-category">Customers</p>
															<h4 class="card-title text-center">{{ total_customers|default:0 }}</h4>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col d-flex">
									<div class="flex-fill">
										<div class="card card-stats card-info card-round">
											<div class="card-body">
												<div class="row">
													<div class="col-5">
														<div class="icon-big text-center">
															<i class="far fa-eye"></i>
														</div>
													</div>
													<div class="col-7 col-stats">
														<div class="numbers">
															<p class="card-category">Detection Systems</p>
															<h4 class="card-title text-center">{{total_detection_systems|default:0}}</h4>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col d-flex">
									<div class="flex-fill">
										<div class="card card-stats card-success card-round">
											<div class="card-body ">
												<div class="row">
													<div class="col-5">
														<div class="icon-big text-center">
															<i class="fas fa-ruler"></i>
														</div>
													</div>
													<div class="col-7 col-stats">
														<div class="numbers">
															<p class="card-category">Rules</p>
															<h4 class="card-title text-center">{{ total_rules|default:0 }}</h4>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col d-flex">
									<div class="flex-fill">
										<div class="card card-stats card-secondary card-round">
											<div class="card-body card-warning ">
												<div class="row">
													<div class="col-5">
														<div class="icon-big text-center">
															<i class="fas fa-glasses"></i>
														</div>
													</div>
													<div class="col-7 col-stats">
														<div class="numbers">
															<p class="card-category">Watchers</p>
															<h4 class="card-title text-center">{{ total_watchers|default:0 }}</h4>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col d-flex">
									<div class="flex-fill">
										<div class="card card-stats card-secondary card-round">
											<div class="card-body ">
												<div class="row">
													<div class="col-5">
														<div class="icon-big text-center">
															<i class="far fa-newspaper"></i>
														</div>
													</div>
													<div class="col-7 col-stats">
														<div class="numbers">
															<p class="card-category">Reports</p>
															<h4 class="card-title text-center">{{ total_reports|default:0 }}</h4>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Rule Stats -->
			<div class="row">
				<div class="col-md-4">
					<div class="card full-height">
						<div class="card-body">
							<div class="card-title">Created Rules This Week</div>
							<div class="row py-3">
								<div class="col-md-4 d-flex flex-column justify-content-around">
									<div>
										<h6 class="fw-bold text-uppercase text-success op-8">Rules</h6>
										<h3 class="fw-bold">{{total_rules_in_week}}</h3>
										<h6 class="fw-bold text-uppercase text-danger op-8">Rules by Type of Detection System</h6>
										{% for type, count in total_rules_by_detection_system_type.items %}
										<h5 class="fw-bold">{{ type }} ({{ count }})</h5>
										{% endfor %}
									</div>
								</div>
								<div class="col-md-8 flex-grow-1">
									<div id="chart-container">
										<canvas id="totalIncomeChartWeek"></canvas>
									</div>
								</div>
							</div>
							<div class="card-title">Created Rules This Year</div>
							<div class="row py-3">
								<div class="col-md-4 d-flex flex-column justify-content-around">
									<div>
										<h6 class="fw-bold text-uppercase text-success op-8">Rules</h6>
										<h3 class="fw-bold">{{total_rules_in_year}}</h3>
									</div>
								</div>
								<div class="col-md-8 flex-grow-1">
									<div id="chart-container" style="height: 100%;">
										<canvas id="totalIncomeChartMonth"></canvas>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-5">
					<div class="card full-height">
						<div class="card-header">
							<div class="card-title">Distribution of Rules by MITRE Tactic</div>
						</div>
						<div class="card-body">
							<div class="chart-container" style="height: 100%;">
								<canvas id="pieChart" style="width: 50%; height: 50%"></canvas>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-3">
					<div class="card full-height">
						<div class="card-header">
							<div class="card-title">Distribution of Rules by Severity</div>
						</div>
						<div class="card-body">
							<div class="chart-container" style="height: 100%;">
								<canvas id="radarChart"></canvas>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Users Stats -->
			<div class="row">
				
				<div class="col-md-4">
					<div class="card full-height">
						<div class="card-header">
							<div class="card-head-row">
								<div class="card-title">Top Rules Creators Today</div>
							</div>
						</div>
						<div id="top-users-today" class="card-body">
							{% if top_users_last_today %}
								{% for user in top_users_last_today %}
								<div class="d-flex">
									<div class="avatar avatar-online">
										<span class="avatar-title rounded-circle border border-white bg-info">{{user|make_list|first|upper}}</span>
									</div>
									<div class="flex-1 ml-3 pt-1">
										<h6 class="text-uppercase fw-bold mb-1">{% if forloop.counter == 1 %}<i class="fas fa-chess-king text-warning"></i>{% endif %} {{user}}</h6>
									</div>
									<div class="float-right pt-1">
										<small class="text-muted">Top {{forloop.counter}}</small>
									</div>
								</div>
								<div class="separator-dashed"></div>
								{% endfor %}
							{% else %}
								<div class="d-flex">
									<p class="text-center"> There're no rules created by any user yet</p>
								</div>
							{% endif %}
						</div>
					</div>
				</div>

				<div class="col-md-4">
					<div class="card full-height">
						<div class="card-header">
							<div class="card-head-row">
								<div class="card-title">Top Rules Creators This Week</div>
							</div>
						</div>
						<div id="top-users-week" class="card-body">
							{% if top_users_last_week %}
								{% for user in top_users_last_week %}
								<div class="d-flex">
									<div class="avatar">
										<span class="avatar-title rounded-circle border border-white bg-info">{{user|make_list|first|upper}}</span>
									</div>
									<div class="flex-1 ml-3 pt-1">
										<h6 class="text-uppercase fw-bold mb-1">{% if forloop.counter == 1 %}<i class="fas fa-chess-king text-warning"></i>{% endif %} {{user}}</h6>
									</div>
									<div class="float-right pt-1">
										<small class="text-muted">Top {{forloop.counter}}</small>
									</div>
								</div>
								<div class="separator-dashed"></div>
								{% endfor %}
							{% else %}
								<div class="d-flex">
									<p class="text-center"> There're no rules created by any user yet</p>
								</div>
							{% endif %}
						</div>
					</div>
				</div>

				<div class="col-md-4">
					<div class="card full-height">
						<div class="card-header">
							<div class="card-head-row">
								<div class="card-title">Top Rules Creators This Month</div>
							</div>
						</div>
						<div id="top-users-week" class="card-body">
							{% if top_users_last_month %}
								{% for user in top_users_last_month %}
								<div class="d-flex">
									<div class="avatar">
										<span class="avatar-title rounded-circle border border-white bg-info">{{user|make_list|first|upper}}</span>
									</div>
									<div class="flex-1 ml-3 pt-1">
										<h6 class="text-uppercase fw-bold mb-1">{% if forloop.counter == 1 %}<i class="fa fa-chess-king text-warning"></i>{% endif %} {{user}}</h6>
									</div>
									<div class="float-right pt-1">
										<small class="text-muted">Top {{forloop.counter}}</small>
									</div>
								</div>
								<div class="separator-dashed"></div>
								{% endfor %}
							{% else %}
								<div class="d-flex">
									<p> There're no rules created by any user yet</p>
								</div>
							{% endif %}
						</div>
					</div>
				</div>

			</div>

			<!-- Activity Stats -->
			<div class="row">
				{% if user.is_superuser %}
					<div class="col-md-3">
						<div class="card full-height">
							<div class="card-header">
								<div class="card-head-row">
									<div class="card-title">Current Active Sessions {% if current_sessions %}({{current_sessions.count}}){% else %}(0){% endif %}</div>
								</div>
							</div>
							<div id="top-users-today" class="card-body">
								<div class="table-responsive"> 
									<table id="sessions-table" class="table table-striped table-striped-bg-default mt-3">
										<thead>
											<tr>
												<th scope="col">ID</th>
												<th scope="col">Expiration time (UTC)</th>
											</tr>
										</thead>
										<tbody>
											{% if current_sessions %}
											{% for session in current_sessions %}
												<tr>
													<td>{{session.session_key}}</td>
													<td>{{session.expire_date }}</td>
												</tr>
											{% endfor %}
											{% else %}
											<p class="text-center">There are not active sessions yet</p>
											{% endif %}
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				{% endif %}
				<div class="col-md-{% if user.is_superuser %}3{% else %}6{% endif %}">
					<div class="card full-height">
						<div class="card-header">
							<div class="card-title">Last Activity</div>
						</div>
						<div class="card-body">
							{% if recent_actions %}
								<ol class="activity-feed">
									<li class="feed-item feed-item-secondary">
										<time class="date" datetime="{{ recent_actions.0.action_time|date:'M d H:m:s' }}">{{ recent_actions.0.action_time|date:'M d H:m:s' }}</time>
										<span class="text">{{ recent_actions.0.user.username }} - {{ recent_actions.0.content_type }}: <a href="/admin/admin/logentry/">{{ recent_actions.0.get_change_message }}</a></span>
									</li>
									<li class="feed-item feed-item-success">
										<time class="date" datetime="{{ recent_actions.1.action_time|date:'M d H:m:s' }}">{{ recent_actions.1.action_time|date:'M d H:m:s' }}</time>
										<span class="text">{{ recent_actions.1.user.username }} - {{ recent_actions.1.content_type }}: <a href="/admin/admin/logentry/">{{ recent_actions.1.get_change_message }}</a></span>
									</li>
									<li class="feed-item feed-item-info">
										<time class="date" datetime="{{ recent_actions.2.action_time|date:'M d H:m:s' }}">{{ recent_actions.2.action_time|date:'M d H:m:s' }}</time>
										<span class="text">{{ recent_actions.2.user.username }} - {{ recent_actions.2.content_type }}: <a href="/admin/admin/logentry/">{{ recent_actions.2.get_change_message }}</a></span>
									</li>
									<li class="feed-item feed-item-warning">
										<time class="date" datetime="{{ recent_actions.3.action_time|date:'M d H:m:s' }}">{{ recent_actions.3.action_time|date:'M d H:m:s' }}</time>
										<span class="text">{{ recent_actions.3.user.username }} - {{ recent_actions.3.content_type }}: <a href="/admin/admin/logentry/">{{ recent_actions.3.get_change_message }}</a></span>
									</li>
									<li class="feed-item feed-item-danger">
										<time class="date" datetime="{{ recent_actions.4.action_time|date:'M d H:m:s' }}">{{ recent_actions.4.action_time|date:'M d H:m:s' }}</time>
										<span class="text">{{ recent_actions.4.user.username }} - {{ recent_actions.4.content_type }}: <a href="/admin/admin/logentry/">{{ recent_actions.4.get_change_message }}</a></span>
									</li>
									<li class="feed-item">
										<time class="date" datetime="{{ recent_actions.5.action_time|date:'M d H:m:s' }}">{{ recent_actions.5.action_time|date:'M d H:m:s' }}</time>
										<span class="text">{{ recent_actions.5.user.username }} - {{ recent_actions.5.content_type }}: <a href="/admin/admin/logentry/">{{ recent_actions.5.get_change_message }}</a></span>
									</li>
									<li class="feed-item feed-item-secondary">
										<time class="date" datetime="{{ recent_actions.6.action_time|date:'M d H:m:s' }}">{{ recent_actions.0.action_time|date:'M d H:m:s' }}</time>
										<span class="text">{{ recent_actions.6.user.username }} - {{ recent_actions.6.content_type }}: <a href="/admin/admin/logentry/">{{ recent_actions.6.get_change_message }}</a></span>
									</li>
								</ol>
							{% else %}
								<p class="text-center">No actions performed yet</p>
							{% endif %}
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="card full-height">
						<div class="card-header">
							<div class="card-head-row">
								<div class="card-title">Last Created Rules</div>
							</div>
						</div>
						<div id="top-users-today" class="card-body">
							<div class="table-responsive"> 
								<table id="last-created-rules-table" class="table table-striped table-striped-bg-default mt-3">
									<thead>
										<tr>
											<th scope="col">ID</th>
											<th scope="col">Name</th>
											<th scope="col">Detection System</th>
											<th scope="col">Created By</th>
											<th scope="col">Created At (UTC)</th>
										</tr>
									</thead>
									<tbody>
										{% if recent_rules %}
										{% for rule in recent_rules %}
											<tr>
												<td>{{rule.id}}</td>
												<td>{{rule.name}}</td>
												<td>{{rule.detection_systems.all|join:", "}}</td>
												<td>{{rule.created_by}}</td>
												<td>{{rule.created_at}}</td>
											</tr>
										{% endfor %}
										{% else %}
										<p class="text-center">There're no rules created yet</p>
										{% endif %}
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!--
			<div class="row row-card-no-pd">
				<div class="col-md-12">
					<div class="card">
						<div class="card-header">
							<div class="card-head-row card-tools-still-right">
								<h4 class="card-title">Users Geolocation</h4>
								<div class="card-tools">
									<button class="btn btn-icon btn-link btn-primary btn-xs"><span class="fa fa-angle-down"></span></button>
									<button class="btn btn-icon btn-link btn-primary btn-xs btn-refresh-card"><span class="fa fa-sync-alt"></span></button>
									<button class="btn btn-icon btn-link btn-primary btn-xs"><span class="fa fa-times"></span></button>
								</div>
							</div>
							<p class="card-category">
							Map of the distribution of users around the world</p>
						</div>
						<div class="card-body">
							<div class="row">
								<div class="col-md-6">
									<div class="table-responsive table-hover table-sales">
										<table class="table">
											<tbody>
												<tr>
													<td>
														<div class="flag">
															<img src="/static/assets/img/flags/id.png" alt="indonesia">
														</div>
													</td>
													<td>Indonesia</td>
													<td class="text-right">
														2.320
													</td>
													<td class="text-right">
														42.18%
													</td>
												</tr>
												<tr>
													<td>
														<div class="flag">
															<img src="/static/assets/img/flags/us.png" alt="united states">
														</div>
													</td>
													<td>USA</td>
													<td class="text-right">
														240
													</td>
													<td class="text-right">
														4.36%
													</td>
												</tr>
												<tr>
													<td>
														<div class="flag">
															<img src="/static/assets/img/flags/au.png" alt="australia">
														</div>
													</td>
													<td>Australia</td>
													<td class="text-right">
														119
													</td>
													<td class="text-right">
														2.16%
													</td>
												</tr>
												<tr>
													<td>
														<div class="flag">
															<img src="/static/assets/img/flags/ru.png" alt="russia">
														</div>
													</td>
													<td>Russia</td>
													<td class="text-right">
														1.081
													</td>
													<td class="text-right">
														19.65%
													</td>
												</tr>
												<tr>
													<td>
														<div class="flag">
															<img src="/static/assets/img/flags/cn.png" alt="china">
														</div>
													</td>
													<td>China</td>
													<td class="text-right">
														1.100
													</td>
													<td class="text-right">
														20%
													</td>
												</tr>
												<tr>
													<td>
														<div class="flag">
															<img src="/static/assets/img/flags/br.png" alt="brazil">
														</div>
													</td>
													<td>Brasil</td>
													<td class="text-right">
														640
													</td>
													<td class="text-right">
														11.63%
													</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mapcontainer">
										<div id="map-example" class="vmap"></div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-4">
					<div class="card">
						<div class="card-header">
							<div class="card-title">Top Products</div>
						</div>
						<div class="card-body pb-0">
							<div class="d-flex">
								<div class="avatar">
									<img src="/static/assets/img/logoproduct.svg" alt="..." class="avatar-img rounded-circle">
								</div>
								<div class="flex-1 pt-1 ml-2">
									<h6 class="fw-bold mb-1">CSS</h6>
									<small class="text-muted">Cascading Style Sheets</small>
								</div>
								<div class="d-flex ml-auto align-items-center">
									<h3 class="text-info fw-bold">+$17</h3>
								</div>
							</div>
							<div class="separator-dashed"></div>
							<div class="d-flex">
								<div class="avatar">
									<img src="/static/assets/img/logoproduct.svg" alt="..." class="avatar-img rounded-circle">
								</div>
								<div class="flex-1 pt-1 ml-2">
									<h6 class="fw-bold mb-1">J.CO Donuts</h6>
									<small class="text-muted">The Best Donuts</small>
								</div>
								<div class="d-flex ml-auto align-items-center">
									<h3 class="text-info fw-bold">+$300</h3>
								</div>
							</div>
							<div class="separator-dashed"></div>
							<div class="d-flex">
								<div class="avatar">
									<img src="/static/assets/img/logoproduct3.svg" alt="..." class="avatar-img rounded-circle">
								</div>
								<div class="flex-1 pt-1 ml-2">
									<h6 class="fw-bold mb-1">Ready Pro</h6>
									<small class="text-muted">Bootstrap 4 Admin Dashboard</small>
								</div>
								<div class="d-flex ml-auto align-items-center">
									<h3 class="text-info fw-bold">+$350</h3>
								</div>
							</div>
							<div class="separator-dashed"></div>
							<div class="pull-in">
								<canvas id="topProductsChart"></canvas>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-4">
					<div class="card">
						<div class="card-body">
							<div class="card-title fw-mediumbold">Suggested People</div>
							<div class="card-list">
								<div class="item-list">
									<div class="avatar">
										<img src="/static/assets/img/jm_denis.jpg" alt="..." class="avatar-img rounded-circle">
									</div>
									<div class="info-user ml-3">
										<div class="username">Jimmy Denis</div>
										<div class="status">Graphic Designer</div>
									</div>
									<button class="btn btn-icon btn-primary btn-round btn-xs">
										<i class="fa fa-plus"></i>
									</button>
								</div>
								<div class="item-list">
									<div class="avatar">
										<img src="/static/assets/img/chadengle.jpg" alt="..." class="avatar-img rounded-circle">
									</div>
									<div class="info-user ml-3">
										<div class="username">Chad</div>
										<div class="status">CEO Zeleaf</div>
									</div>
									<button class="btn btn-icon btn-primary btn-round btn-xs">
										<i class="fa fa-plus"></i>
									</button>
								</div>
								<div class="item-list">
									<div class="avatar">
										<img src="/static/assets/img/talha.jpg" alt="..." class="avatar-img rounded-circle">
									</div>
									<div class="info-user ml-3">
										<div class="username">Talha</div>
										<div class="status">Front End Designer</div>
									</div>
									<button class="btn btn-icon btn-primary btn-round btn-xs">
										<i class="fa fa-plus"></i>
									</button>
								</div>
								<div class="item-list">
									<div class="avatar">
										<img src="/static/assets/img/mlane.jpg" alt="..." class="avatar-img rounded-circle">
									</div>
									<div class="info-user ml-3">
										<div class="username">John Doe</div>
										<div class="status">Back End Developer</div>
									</div>
									<button class="btn btn-icon btn-primary btn-round btn-xs">
										<i class="fa fa-plus"></i>
									</button>
								</div>
								<div class="item-list">
									<div class="avatar">
										<img src="/static/assets/img/talha.jpg" alt="..." class="avatar-img rounded-circle">
									</div>
									<div class="info-user ml-3">
										<div class="username">Talha</div>
										<div class="status">Front End Designer</div>
									</div>
									<button class="btn btn-icon btn-primary btn-round btn-xs">
										<i class="fa fa-plus"></i>
									</button>
								</div>
								<div class="item-list">
									<div class="avatar">
										<img src="/static/assets/img/jm_denis.jpg" alt="..." class="avatar-img rounded-circle">
									</div>
									<div class="info-user ml-3">
										<div class="username">Jimmy Denis</div>
										<div class="status">Graphic Designer</div>
									</div>
									<button class="btn btn-icon btn-primary btn-round btn-xs">
										<i class="fa fa-plus"></i>
									</button>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-4">
					<div class="card card-primary bg-primary-gradient">
						<div class="card-body">
							<h4 class="mt-3 b-b1 pb-2 mb-4 fw-bold">Active user right now</h4>
							<h1 class="mb-4 fw-bold">17</h1>
							<h4 class="mt-3 b-b1 pb-2 mb-5 fw-bold">Page view per minutes</h4>
							<div id="activeUsersChart"></div>
							<h4 class="mt-5 pb-3 mb-0 fw-bold">Top active pages</h4>
							<ul class="list-unstyled">
								<li class="d-flex justify-content-between pb-1 pt-1"><small>/product/readypro/index.html</small> <span>7</span></li>
								<li class="d-flex justify-content-between pb-1 pt-1"><small>/product/atlantis/demo.html</small> <span>10</span></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			-->
			
		</div>
	</div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

	<!-- Atlantis DEMO methods, don't include it in your project! -->
	<script src="/static/assets/js/setting-demo.js"></script>
	{% if user.is_superuser%}
	<script>
		$(document).ready(function() {
			$('#sessions-table').DataTable({
				"scrollY": true
			});
		});
	</script>
	{% endif %}
	<script>
		$(document).ready(function() {
			$('#last-created-rules-table').DataTable({
				"scrollY": true,
				"scrollX": true
			});
		});
	</script>
	<script>
		var totalIncomeChartWeek = document.getElementById('totalIncomeChartWeek').getContext('2d'),
		pieChart = document.getElementById('pieChart').getContext('2d'),
		radarChart = document.getElementById('radarChart').getContext('2d');
		
		var mytotalIncomeChartWeek = new Chart(totalIncomeChartWeek, {
			type: 'bar',
			data: {
				labels: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],
				datasets : [{
					label: "Rules",
					backgroundColor: '#ff9e27',
					borderColor: 'rgb(23, 125, 255)',
					data: {{ rules_by_day_list }},
				}],
			},
			options: {
				responsive: true,
				maintainAspectRatio: false,
				legend: {
					display: false,
				},
				scales: {
					yAxes: [{
						ticks: {
							display: false //this will remove only the label
						},
						gridLines : {
							drawBorder: false,
							display : false
						}
					}],
					xAxes : [ {
						gridLines : {
							drawBorder: false,
							display : false
						}
					}]
				},
			}
		});

		var totalIncomeChartMonth = document.getElementById('totalIncomeChartMonth').getContext('2d');

		var mytotalIncomeChartMonth = new Chart(totalIncomeChartMonth, {
			type: 'bar',
			data: {
				labels: ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"],
				datasets: [{
					label: "Rules",
					backgroundColor: '#7db6ff',
					borderColor: 'rgb(125, 182, 255)',
					data: {{rules_by_month_list}},
				}],
			},
			options: {
				responsive: true,
				maintainAspectRatio: false,
				legend: {
					display: false,
				},
				scales: {
					yAxes: [{
						ticks: {
							display: false //this will remove only the label
						},
						gridLines : {
							drawBorder: false,
							display : false
						}
					}],
					xAxes : [ {
						gridLines : {
							drawBorder: false,
							display : false
						}
					}]
				},
			}
		});

		var myRadarChart = new Chart(radarChart, {
			type: 'radar',
			data: {
				labels: ['Critical', 'Very High', 'High', 'Medium', 'Low', 'Informational'],
				datasets: [{
					data: {{distribution_by_severity}},
					borderColor: '#1d7af3',
					backgroundColor : 'rgba(29, 122, 243, 0.25)',
					pointBackgroundColor: "#1d7af3",
					pointHoverRadius: 4,
					pointRadius: 3,
					label: 'Rules'
				},
				]
			},
			options : {
				responsive: true, 
				maintainAspectRatio: false,
				legend : {
					position: 'bottom',
				},
				scale: {
					pointLabels: {
						fontSize: 12,  // Ajusta el tamaño de fuente deseado
					}
				}
			}
		});

		var myPieChart = new Chart(pieChart, {
			type: 'pie',
			data: {
				datasets: [{
					data: {{distribution_by_tactic}},
					backgroundColor: [
						"#1d7af3",  // Initial Access
						"#f3545d",  // Execution
						"#fdaf4b",  // Persistence
						"#6ab04c",  // Privilege Escalation
						"#f9c851",  // Defense Evasion
						"#4b7ad3",  // Credential Access
						"#ff8b34",  // Discovery
						"#8d6cab",  // Lateral Movement
						"#e36064",  // Collection
						"#32b4a6",  // Command and Control
						"#f9a9a3",  // Exfiltration
						"#3c434c",  // Impact
						"#b7dbab",  // Resource Development
						"#aab9d9",  // Reconnaissance
						],
					borderWidth: 0
				}],
				labels: ['Initial Access','Execution', 'Persistence', 'Privilege Escalation', 'Defense Evasion', 'Credential Access', 'Discovery', 'Lateral Movement', 'Collection', 'Command and Control', 'Exfiltration', 'Impact', 'Resource Development', 'Reconnaissance'] 
			},
			options : {
				responsive: true, 
				maintainAspectRatio: false,
				legend: {
					position : 'bottom',
					labels : {
						fontColor: 'rgb(154, 154, 154)',
						fontSize: 11,
						usePointStyle : true,
						padding: 20
					}
				},
				pieceLabel: {
					render: function(args) {
						var value = args.value;
						var percentage = args.percentage.toFixed(1) + '%';
						return value + ' (' + percentage + ')';
					  },
					fontColor: 'white',
					fontSize: 10,
				},
				tooltips: false,
				layout: {
					padding: {
						left: 20,
						right: 20,
						top: 20,
						bottom: 20
					}
				}
			}
		});
		
		$('#lineChart').sparkline([105,103,123,100,95,105,115], {
			type: 'line',
			height: '70',
			width: '100%',
			lineWidth: '2',
			lineColor: '#ffa534',
			fillColor: 'rgba(255, 165, 52, .14)'
		});
	</script>

{% endblock javascripts %}
